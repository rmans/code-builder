---
id: TASK-2025-09-07-T7.1-rules-integration
title: Rules System Integration â€“ docs/rules/
description: Honor style/format rules in generated docs and reference in front-matter
status: completed
created: 2025-09-07
updated: 2025-09-07
owner: docs-agent
domain: docs
priority: 6
agent_type: backend
dependencies: [T3.1]
tags: [rules, docs]
---

# Task: Rules System Integration â€“ docs/rules/

## Phases
### Phase 1: ðŸš€ Implementation
- [x] Incorporate rules checks during generation
- [x] Include rule refs in doc front-matter

### Phase 2: ðŸ§ª Testing
- [x] Spot-check rule violations flagged correctly

### Phase 3: ðŸ“š Documentation
- [x] Describe rules in index

### Phase 4: ðŸ§¹ Cleanup
- [x] Suppress noisy non-actionable warnings

### Phase 5: ðŸ’¾ Commit
- [x] Commit

## Acceptance Criteria
- [x] PRD/ARCH/INT/IMPL/EXEC include rule refs

## Completion Summary

**Status**: âœ… COMPLETED

**Implementation Details**:
- âœ… Created comprehensive rules integration system in `builder/utils/rules_integration.py`
- âœ… Implemented `RulesChecker` class for pattern-based rule violation detection
- âœ… Implemented `RulesIntegrator` class for document validation and rule reference addition
- âœ… Added CLI commands: `rules:check`, `rules:check-content`, `rules:validate-doc`, `rules:list`, `rules:add-refs`
- âœ… Integrated rules checking into `ContextBuilder` document generation
- âœ… Added automatic rule reference inclusion in document front-matter

**Generated Files**:
- âœ… `builder/utils/rules_integration.py` - Core rules integration system
- âœ… `builder/core/cli/rules_commands.py` - CLI commands for rules management
- âœ… Updated `builder/core/context_builder.py` - Integrated rules validation

**Testing Results**:
- âœ… `rules:list` shows all available rules (37 forbidden patterns, 7 hints, 9 rule files)
- âœ… `rules:check` validates files against rules without violations
- âœ… Document generation includes rule references in front-matter
- âœ… PRD generation includes rules: `00-global.md`, `10-project.md`, `15-implementation.md`
- âœ… Rules validation works during document generation

**Key Features**:
- **Pattern-Based Validation**: Uses regex patterns to detect rule violations
- **Severity Levels**: Distinguishes between errors, warnings, and hints
- **Rule References**: Automatically adds relevant rule files to document front-matter
- **Document Type Awareness**: Selects appropriate rules based on document type
- **CLI Integration**: Comprehensive command set for rules management
- **Generation Integration**: Validates documents during generation process

**Rule Categories**:
- **Forbidden Patterns**: 37 patterns for security, best practices, and code quality
- **Hints**: 7 helpful suggestions for code improvement
- **Rule Files**: 9 markdown files with detailed rule documentation

**Integration Points**:
- Integrated with `ContextBuilder` for automatic validation during generation
- Uses existing `guardrails.json` configuration
- Provides CLI interface for manual rules checking
- Supports multiple document types (PRD, ARCH, INT, IMPL, EXEC)
- Generates human-readable violation reports
